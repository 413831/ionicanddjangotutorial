<!DOCTYPE HTML> 
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
--> 
<html> 
    <head> 
        <title>Create an API with Django Rest Framework - Part Two</title>
        <meta name="description" content="Learn to create an API with django rest framework to be able to use with a ionic 4 project - Part two - Ionic and Django Tutorial"/>
        <meta name="author" content="surbier christophe">
        <meta charset="utf-8"/> 
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/> 
        <link rel="stylesheet" href="assets/css/main.css"/>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-125461829-1"></script>
        <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-125461829-1');
</script>
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <style>.mySlides {
    display: none;
}</style>
        <style>.responsiveimage {
    width: 100%;
    height: auto;
}</style>
    </head>     
    <body class="is-preload"> 
        <!-- Wrapper -->         
        <div id="wrapper"> 
            <!-- Main -->             
            <div id="main"> 
                <div class="inner"> 
                    <!-- Header -->                     
                    <header id="header"> 
                        <a href="/" class="logo"><strong>Ionic and Django Tutorial</strong></a>
                        <ul class="icons">
                            <li>Share on 
                                <!-- AddToAny BEGIN -->
                                <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
                                    <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
                                    <a class="a2a_button_facebook"></a>
                                    <a class="a2a_button_twitter"></a>
                                    <a class="a2a_button_linkedin"></a>
                                </div>
                                <script async src="https://static.addtoany.com/menu/page.js"></script>
                                <!-- AddToAny END -->                                 
                            </li>
                        </ul>                         
                    </header>                     
                    <section> 
                        <header class="major"> 
                            <h1>Django Rest Framework : How to create an API easily, part two </h1>
                            <b>April 14, 2019</b>
                        </header>                         
                        <span class="image main"></span> 
                        <div>
                            <p>
                                Before to define some url endpoints, create a <b>serializers.py</b> file inside the <b>api</b> directory: <pre><code>touch serializers.py</code></pre> </p>
                            <p>
                                This file will contain all serializers for our Django models. A serializer is a class to help converting our python model object into a JSON object, which can be understand by our api client (inside our Ionic project).  </p>
                            <p>
                            Our first endpoint, will be to get the list of existing users in our backend. So we need to add the following lines in our <b>urls.py</b> file inside our <b>api</b> directory: <pre><code>from django.urls import path
from django.conf.urls import include
from rest_framework.routers import DefaultRouter
router = DefaultRouter()
from api.views import *
urlpatterns = [
    path('users/', UserListView.as_view(), name='users_list'),
    path('', include(router.urls))
]</code></pre> </p>
                            <p>
                        With this code, we declare a new url which will be <b>/users</b> and which will use the views <b>UserListView</b> declare in a file <b>views.py</b> so let's create that file (still in our api directory): <pre><code>touch views.py</code></pre> </p>
                            <p>
                    And add the following code inside the <b>views.py</b>: <pre><code># *coding: utf-8*
from backoffice.models import User
from api.serializers import *
from rest_framework import generics
class UserListView(generics.ListAPIView):
    """
            get:
                Search or get users
    """
    queryset = User.objects.all()
    serializer_class = UserSerializer</code></pre> </p>
                            <p>
                With this code, we use the power of Django Rest Framework. We just need to tell django that our model is <b>User</b>, we define a queryset to get the data and we specify the class used to serialize data. </p>
                            <p>
                So we need to create our <b>UserSerializer</b> class. Inside the previously empty file <b>serializers.py</b> that we created, add the code: <pre><code>from backoffice.models import *
from rest_framework import serializers
class UserSerializer(serializers.ModelSerializer):
    class Meta:
        model = User
        fields = '__all__'</code></pre> </p>
                            <p>
            It is still pretty simple and obvious. In the serializer, we say that we are using the <b>User</b> model and that we want to serialize all fields (meaning all fields will be part of the JSON response). </p>
                            <p>
            Now if you open your browser to the following url : http://127.0.0.1:8000/api/users/ you should see :  </p>
                            <p> <img src="images/djangorestframework/rest-get-users.png" class="responsiveimage"> </p>
                            <p>
            This is the JSON response that our API is sending back (as you can see Content-Type is application/json) with the existing users that i have created before in the database (with the admin interface). The <b>count</b> field indicates how many objects we have in our user list, the <b>next</b> and <b>previous</b> fields are used to indicate the pagination. Indeed if you remember in the <b>settings.py</b> file, we declare a  <pre><code>
#Rest
REST_FRAMEWORK = {
...
'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
'PAGE_SIZE': 20,
}</code></pre> </p>
                            <p>
        So Django Rest Framework will automatically paginate results 20 by 20.<br>
        Of course now you can call the API with your favorite tools (cURL, Postman...) and verify that you get data. But this time to introduce a new great library for Django Rest Framework which will generate our browsable documentation for our API plus a tool to test our endpoints (do Http request easily).<br><br>
        The library is called : <a href="https://www.drfdocs.com/" _target="_blank">Drf Docs</a> but be careful, it's not working anymore with Django 2.x version. So instead we will use a fork of this library, which solve the Django 2.x problem plus another problem about regex urls. Don't worry about it and just add in the <b>requirements.txt</b> file, the line: <pre><code>git+https://github.com/mago960806/django-rest-framework-docs.git</code></pre> </p>
                            <p>
    then launch in terminal:<pre><code>pip3 install -r requirements.txt</code></pre></p>
                            <p>
    In <b>settings.py</b> file, inside the INSTALLED_APPS add : <pre><code>'rest_framework_docs',</code></pre></p>
                            <p>
    and in our global <b>urls.py</b> file, we declare the endpoint of our documentation: <pre><code>  path('doc/', include('rest_framework_docs.urls')),</code></pre></p>
                            <p>
    Now if your relaunch the project (python3 manage.py runserver) and open your browser to /doc url you should see: </p>
                            <p> <img src="images/djangorestframework/rest-doc-2.png" class="responsiveimage"></p> 
                            <p>
    This view list all endpoints available and each method available for the endpoint. To get the documentation and fields available, just click the HTTP Method that has been implemented in the API (only GET at the moment)</p>
                            <p>
    Now if you want to test your endpoint request, you can click to the icon next to the Options buttons, and you should see a popup opens:</p>
                            <p> <img src="images/djangorestframework/rest-doc-1.png" class="responsiveimage"></p> 
                            <p>
    This is still in beta but i didn't have any issues so far (just remember it's a beta). Pretty awesome isn't it ?</p>
                            <h2>How to filter with Django Rest Framework</h2>
                            <p> </p>
                        </div>
                    </section>
                </div>
            </div>
            <!-- Sidebar -->             
            <div id="sidebar"> 
                <div class="inner"> 
                    <!-- Menu -->                     
                    <nav id="menu"> 
                        <header class="major"> 
                            <h2>Menu</h2> 
                        </header>                         
                        <ul> 
                            <li>
                                <a href="/">Homepage</a>
                            </li>                             
                            <li>
                                <a href="terms.html">Terms and conditions</a>
                            </li>
                            <li>
                                <a href="policy.html">Privacy Policy</a>
                            </li>                             
                        </ul>                         
                    </nav>                     
                    <!-- Section -->                     
                    <section> 
                        <header class="major"> 
                            <h2>Get in touch</h2> 
                        </header>                         
                        <p>For any questions, remarks or any development requirement.</p> 
                        <ul class="contact"> 
                            <li class="fa-envelope-o">
                                <a href="mailto:csurbier@idevotion.fr">csurbier@idevotion.fr</a>
                            </li>                             
                            <li class="fa-home">Carrer Riera blanca, 45-47
                                <br/> 
                                08028 Barcelona
                            </li>                             
                        </ul>                         
                    </section>                     
                    <!-- Footer -->                     
                    <footer id="footer"> 
                        <p class="copyright">&copy; Surbier Christophe. All rights reserved. Development: <a href="https://www.idevotion.fr">iDevotion</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.</p> 
                    </footer>                     
                </div>                 
            </div>             
        </div>         
        <!-- Scripts -->         
        <script src="assets/js/jquery.min.js"></script>         
        <script src="assets/js/browser.min.js"></script>         
        <script src="assets/js/breakpoints.min.js"></script>         
        <script src="assets/js/util.js"></script>         
        <script src="assets/js/main.js"></script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5248722664237652" data-ad-slot="8488918554" data-ad-format="auto" data-full-width-responsive="true"></ins>
        <script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
        <div id="disqus_thread"></div>
        <script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT 
     *  THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR 
     *  PLATFORM OR CMS.
     *  
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: 
     *  https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_config = function () {
        // Replace PAGE_URL with your page's canonical URL variable
        this.page.url = "https://www.ionicanddjangotutorial.com/design-and-setup.html";  
        
        // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.identifier = "dayone-designsetup"; 
    };
    
    (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document, s = d.createElement('script');
        
        // IMPORTANT: Replace EXAMPLE with your forum shortname!
        s.src = 'https://https-www-ionicanddjangotutorial-com.disqus.com/embed.js'
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
        <noscript>
            Please enable JavaScript to view the 
            <a href="https://disqus.com/?ref_noscript" rel="nofollow">
        comments powered by Disqus. </a>
        </noscript>         
        <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://www.ionicanddjangotutorial.com",
      "contactPoint": [{
        "@type": "ContactPoint",
        "email": "csurbier@idevotion.fr",
        "contactType": "customer support"
      }]
    }
  </script>
        <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Course",
      "name": "Ionic and Django tutorial",
      "description": "A tutorial to learn mobile application development from scratch and on a concrete use case, using Ionic 4 as frontend and Django as backend.",
      "provider": {
        "@type": "Organization",
        "name": "iDevotion",
        "sameAs": "https://www.ionicanddjangotutorial.com"
      }
    }
  </script>
    </body>     
</html>